// Copyright 2023 Naon Lu
//
// This file describes the solution of
// Prime In Diagonal
//
// https://leetcode.com/problems/prime-in-diagonal/
//
// Question ID: 2614
// Difficult  : Easy
// Solve Date : 2023/05/19 11:34

#include <iosfwd>
#include <vector>

// -- This header must be included after others --
#include "leetcode/testing/solution_test_helper.h"

using namespace std;
using namespace lcd;

// Description of |2614. Prime In Diagonal|:
//
// You are given a 0-indexed two-dimensional integer array |nums|.
// Return the largest prime number that lies on at least one of the diagonals of
// |nums|. In case, no prime is present on any of the diagonals, return 0. Note
// that:
//
//  • An integer is prime if it is greater than |1| and has no positive integer
//  divisors other than |1| and itself.
//
//  • An integer |val| is on one of the diagonals of |nums| if there exists an
//  integer |i| for which |nums[i][i] = val| or an |i| for which
//  |nums[i][nums.length - i - 1] = val|.
// ![img](https://assets.leetcode.com/uploads/2023/03/06/screenshot-2023-03-06-at-45648-pm.png)
// In the above diagram, one diagonal is [1,5,9] and another diagonal is
// [3,5,7].
//
//

LEETCODE_BEGIN_RESOLVING(2614, PrimeInDiagonal, Solution);

class Solution {
public:
  int diagonalPrime(vector<vector<int>> &nums) {
    int res = 0;
    int n   = nums.size();
    for (int i = 0; i < n; ++i) {
      int d1 = nums[i][i];
      int d2 = nums[n - i - 1][i];
      res    = max(res, isPrime(d1) ? d1 : -1);
      res    = max(res, isPrime(d2) ? d2 : -1);
    }
    return res;
  }

private:
  bool isPrime(int x) {
    if (x < 2)
      return false;
    for (int i = 2; i * i <= x; ++i) {
      if (x % i == 0) {
        return false;
      }
    }
    return true;
  }
};

LEETCODE_END_RESOLVING(Solution);

///////////////////////////////////////////////////////////////////////////////
// The following is test data for unit test.
// Note that inputs should be obey the constraints mentioned in LeetCode:
// * |1 <= nums.length <= 300|
// * |nums.length == numsᵢ.length|
// * |1 <= nums[i][j] <= 4*10⁶|
///////////////////////////////////////////////////////////////////////////////

// [Example #1]
//  Input: nums = [[1,2,3],[5,6,7],[9,10,11]]
// Output: 11
//
// The numbers 1, 3, 6, 9, and 11 are the only numbers present on at least one
// of the diagonals. Since 11 is the largest prime, we return 11.

LEETCODE_SOLUTION_UNITTEST(2614, PrimeInDiagonal, example_1) {
  auto                solution = MakeSolution();
  vector<vector<int>> nums     = {
      {1,  2,  3},
      {5,  6,  7},
      {9, 10, 11}
  };
  int expect = 11;
  int actual = solution->diagonalPrime(nums);
  LCD_EXPECT_EQ(expect, actual);
}

// [Example #2]
//  Input: nums = [[1,2,3],[5,17,7],[9,11,10]]
// Output: 17
//
// The numbers 1, 3, 9, 10, and 17 are all present on at least one of the
// diagonals. 17 is the largest prime, so we return 17.

LEETCODE_SOLUTION_UNITTEST(2614, PrimeInDiagonal, example_2) {
  auto                solution = MakeSolution();
  vector<vector<int>> nums     = {
      {1,  2,  3},
      {5, 17,  7},
      {9, 11, 10}
  };
  int expect = 17;
  int actual = solution->diagonalPrime(nums);
  LCD_EXPECT_EQ(expect, actual);
}

// [Extra Testcase #1]
//  Input:
//  [[395,777,912,431,42,266,989,524,498,415,941,803,850,311,992,489,367,598,914,930,224,517,143,289,144,774,98,634],[819,257,932,546,723,830,617,924,151,318,102,748,76,921,871,701,339,484,574,104,363,445,324,626,656,935,210,990],[566,489,454,887,534,267,64,825,941,562,938,15,96,737,861,409,728,845,804,685,641,2,627,506,848,889,342,250],[748,334,721,892,65,196,940,582,228,245,823,991,146,823,557,459,94,83,328,897,521,956,502,112,309,565,299,724],[128,561,341,835,945,554,209,987,819,618,561,602,295,456,94,611,818,395,325,590,248,298,189,194,842,192,34,628],[673,267,488,71,92,696,776,134,898,154,946,40,863,83,920,717,946,850,554,700,401,858,723,538,283,535,832,242],[870,221,917,696,604,846,973,430,594,282,462,505,677,657,718,939,813,366,85,333,628,119,499,602,646,344,866,195],[249,17,750,278,120,723,226,381,814,175,341,437,836,64,104,802,150,876,715,225,47,837,588,650,932,959,548,617],[697,76,28,128,651,194,621,851,590,123,401,94,380,854,119,38,621,23,200,985,994,190,736,127,491,216,745,820],[63,960,696,24,558,436,636,104,856,267,72,227,74,663,309,359,447,185,63,516,479,41,611,104,717,401,205,267],[368,927,750,482,859,924,941,584,174,715,689,209,990,786,60,808,693,163,866,166,351,543,257,121,612,944,453,682],[180,14,483,698,420,922,583,896,521,940,319,665,366,398,858,674,257,158,575,708,13,469,760,81,344,757,47,558],[288,139,246,781,977,494,361,625,295,690,368,605,970,914,649,875,636,136,733,318,398,767,425,849,667,83,2,609],[197,716,343,164,246,229,653,459,388,728,897,690,582,896,425,33,412,893,719,582,429,791,679,727,48,170,457,66],[266,719,162,458,541,907,499,930,575,619,774,1,906,40,507,334,320,858,479,52,829,843,897,998,832,426,193,562],[987,649,86,858,743,134,16,412,973,695,428,324,4,219,15,735,773,3,843,692,542,627,101,196,122,623,665,204],[895,310,287,706,187,103,488,875,945,407,643,84,23,282,936,464,820,812,119,883,263,137,670,534,837,667,661,356],[118,893,159,286,872,20,44,42,211,698,266,572,323,970,376,961,582,932,870,44,867,768,985,719,623,672,507,730],[660,925,470,656,446,382,893,551,183,213,385,602,299,10,142,155,278,342,346,809,377,736,96,347,799,636,37,43],[277,168,154,598,297,370,405,562,133,301,118,490,749,246,957,50,316,184,878,536,747,73,310,413,856,337,307,425],[112,102,575,931,493,486,346,862,818,1000,832,352,128,491,119,717,510,437,39,310,344,753,704,916,160,942,171,642],[579,385,826,998,655,90,68,828,87,203,768,227,63,395,9,101,404,570,532,297,460,943,501,808,599,732,696,223],[434,86,378,226,268,600,796,171,442,197,368,118,66,842,885,874,719,29,925,539,463,771,694,207,122,510,408,263],[213,657,44,971,817,222,639,150,108,203,470,388,371,560,847,155,108,611,500,152,578,416,654,697,434,899,534,508],[696,940,910,331,854,511,511,651,687,896,207,556,625,954,225,10,349,723,986,765,921,326,838,330,37,538,152,896],[264,618,803,160,863,389,597,302,736,724,827,482,68,820,87,529,890,938,41,68,231,134,42,308,16,778,865,460],[339,883,165,820,153,890,672,472,992,381,518,392,923,543,515,35,588,93,695,814,825,531,777,615,79,765,437,928],[773,212,297,549,923,613,428,846,996,494,866,811,996,398,623,601,240,872,886,818,21,673,907,1,759,187,310,520]]
// Output: 883
//

LEETCODE_SOLUTION_UNITTEST(2614, PrimeInDiagonal, extra_testcase_1) {
  auto                solution = MakeSolution();
  vector<vector<int>> nums     = {
      {395,  777,  912,  431,   42, 266, 989,  524,  498,  415, 941,  803,   850,   311,
       992,   489,  367, 598,   914,  930,  224,  517,   143,  289,   144,  774,  98,  634 },
      {819,  257,  932,  546,  723,  830, 617,  924,  151,  318, 102,  748,    76,  921,
       871,   701,  339, 484,   574,  104,  363,  445,   324,  626,   656,  935, 210,   990},
      {566,  489,  454,  887,  534,  267,  64, 825,  941,  562, 938,   15,   96,  737,
       861,   409,  728, 845,   804,  685,  641,    2, 627,  506,   848,  889, 342,   250  },
      {748,  334,  721,  892,   65, 196, 940,  582,  228,  245, 823,  991,   146,   823,
       557,   459,   94, 83,  328,  897,  521,  956,   502,  112,   309,  565, 299,   724  },
      {128,  561,  341,  835,  945,  554, 209,  987,  819,  618, 561,  602,   295,   456,
       94,  611,  818, 395,   325,  590,  248,  298,   189,  194,   842,  192,  34,  628   },
      {673,  267,  488,   71,  92, 696, 776,  134,  898,  154, 946,   40,  863,    83,
       920,   717,  946, 850,   554,  700,  401,  858,   723,  538,   283,  535, 832,   242},
      {870,  221,  917,  696,  604,  846, 973,  430,  594,  282, 462,  505,   677,   657,
       718,   939,  813, 366,    85, 333,  628,  119,   499,  602,   646,  344, 866,   195 },
      {249,   17, 750,  278,  120,  723, 226,  381,  814,  175, 341,  437,   836,    64,
       104,   802,  150, 876,   715,  225,   47, 837,   588,  650,   932,  959, 548,   617 },
      {697,   76,   28, 128,  651,  194, 621,  851,  590,  123, 401,   94,  380,   854,
       119,    38,  621,  23,  200,  985,  994,  190,   736,  127,   491,  216, 745,   820 },
      { 63, 960,  696,   24, 558,  436, 636,  104,  856,  267,  72, 227,    74,  663,
       309,   359,  447, 185,    63, 516,  479,   41,  611,  104,   717,  401, 205,   267  },
      {368,  927,  750,  482,  859,  924, 941,  584,  174,  715, 689,  209,   990,   786,
       60,  808,  693, 163,   866,  166,  351,  543,   257,  121,   612,  944, 453,   682  },
      {180,   14, 483,  698,  420,  922, 583,  896,  521,  940, 319,  665,   366,   398,
       858,   674,  257, 158,   575,  708,   13, 469,   760,   81,  344,  757,  47,  558   },
      {288,  139,  246,  781,  977,  494, 361,  625,  295,  690, 368,  605,   970,   914,
       649,   875,  636, 136,   733,  318,  398,  767,   425,  849,   667,   83,  2, 609   },
      {197,  716,  343,  164,  246,  229, 653,  459,  388,  728, 897,  690,   582,   896,
       425,    33, 412, 893,   719,  582,  429,  791,   679,  727,    48, 170, 457,    66  },
      {266,  719,  162,  458,  541,  907, 499,  930,  575,  619, 774,    1, 906,    40,
       507,   334,  320, 858,   479,   52, 829,  843,   897,  998,   832,  426, 193,   562 },
      {987,  649,   86, 858,  743,  134,  16, 412,  973,  695, 428,  324,     4, 219,
       15,  735,  773,   3, 843,  692,  542,  627,   101,  196,   122,  623, 665,   204    },
      {895,  310,  287,  706,  187,  103, 488,  875,  945,  407, 643,   84,   23,  282,
       936,   464,  820, 812,   119,  883,  263,  137,   670,  534,   837,  667, 661,   356},
      {118,  893,  159,  286,  872,   20,  44,  42, 211,  698, 266,  572,   323,   970,
       376,   961,  582, 932,   870,   44,  867,  768,   985,  719,   623,  672, 507,   730},
      {660,  925,  470,  656,  446,  382, 893,  551,  183,  213, 385,  602,   299,    10,
       142,   155,  278, 342,   346,  809,  377,  736,    96, 347,   799,  636,  37,   43  },
      {277,  168,  154,  598,  297,  370, 405,  562,  133,  301, 118,  490,   749,   246,
       957,    50, 316, 184,   878,  536,  747,   73,  310,  413,   856,  337, 307,   425  },
      {112,  102,  575,  931,  493,  486, 346,  862,  818, 1000, 832,  352,   128,   491,
       119,   717,  510, 437,    39, 310,  344,  753,   704,  916,  160,  942, 171,   642  },
      {579,  385,  826,  998,  655,   90, 68, 828,   87, 203, 768,  227,    63,  395,
       9, 101,  404, 570,   532,  297,  460,  943,   501,  808,   599,  732, 696,   223    },
      {434,   86, 378,  226,  268,  600, 796,  171,  442,  197, 368,  118,    66,  842,
       885,   874,  719,  29,  925,  539,  463,  771,   694,  207,   122,  510, 408,   263 },
      {213,  657,   44, 971,  817,  222, 639,  150,  108,  203, 470,  388,   371,   560,
       847,   155,  108, 611,   500,  152,  578,  416,   654,  697,   434,  899, 534,   508},
      {696,  940,  910,  331,  854,  511, 511,  651,  687,  896, 207,  556,   625,   954,
       225,    10, 349, 723,   986,  765,  921,  326,   838,  330,    37, 538, 152,   896  },
      {264,  618,  803,  160,  863,  389, 597,  302,  736,  724, 827,  482,    68,  820,
       87,  529,  890, 938,    41,  68, 231,  134,    42, 308,    16, 778, 865,   460      },
      {339,  883,  165,  820,  153,  890, 672,  472,  992,  381, 518,  392,   923,   543,
       515,    35, 588,  93,  695,  814,  825,  531,   777,  615,    79, 765, 437,   928   },
      {773,  212,  297,  549,  923,  613, 428,  846,  996,  494, 866,  811,   996,   398,
       623,   601,  240, 872,   886,  818,   21, 673,   907,    1, 759,  187, 310,   520   }
  };
  int expect = 883;
  int actual = solution->diagonalPrime(nums);
  LCD_EXPECT_EQ(expect, actual);
}

// [Extra Testcase #2]
//  Input:
//  [[788,645,309,559],[624,160,435,724],[770,483,95,695],[510,779,984,238]]
// Output: 0
//

LEETCODE_SOLUTION_UNITTEST(2614, PrimeInDiagonal, extra_testcase_2) {
  auto                solution = MakeSolution();
  vector<vector<int>> nums     = {
      {788, 645, 309, 559},
      {624, 160, 435, 724},
      {770, 483,  95, 695},
      {510, 779, 984, 238}
  };
  int expect = 0;
  int actual = solution->diagonalPrime(nums);
  LCD_EXPECT_EQ(expect, actual);
}

// [Extra Testcase #3]
//  Input:
//  [[740,493,326,111,693,464,378,599,714,260,683,499,832,795,235,945,163,576,565,848,917,80,800,877,521,943,908],[173,27,848,659,870,171,900,530,419,623,677,214,449,726,701,415,271,22,602,138,942,398,176,907,452,579,55],[939,385,952,822,89,660,603,415,343,239,519,895,467,41,492,635,105,276,854,520,503,565,661,404,485,272,186],[236,554,374,164,310,873,624,852,939,148,468,71,986,71,490,403,580,976,420,570,95,272,494,236,835,114,304],[145,369,832,97,142,675,885,59,843,682,141,601,573,204,8,34,883,415,572,717,774,617,503,732,707,110,954],[485,573,356,896,799,352,894,100,703,6,248,233,510,859,319,282,231,10,508,364,970,978,522,949,350,94,80],[313,588,433,232,757,377,987,391,882,777,149,238,295,959,205,761,795,493,676,902,801,368,290,394,628,133,852],[798,123,411,364,513,890,483,235,672,727,383,648,938,368,443,285,368,997,411,786,785,732,290,888,108,492,926],[299,124,457,158,353,956,250,762,192,952,979,347,512,235,113,698,394,999,399,476,526,473,959,580,849,633,226],[692,409,515,319,499,239,323,531,701,2,95,484,325,404,913,973,233,841,991,442,50,590,790,42,417,96,270],[206,743,335,183,116,186,817,716,373,29,240,976,45,9,392,548,5,133,120,842,620,621,958,935,205,84,759],[478,203,869,2,533,919,637,867,426,69,550,182,949,240,233,951,426,392,487,827,1,447,216,391,1000,784,43],[631,978,276,30,597,356,721,377,847,346,694,465,657,138,611,530,95,258,968,106,732,106,280,25,709,146,636],[791,675,140,389,213,587,1000,676,328,207,432,521,513,124,574,109,710,933,487,128,522,915,459,482,183,466,561],[348,132,427,261,387,81,579,518,344,840,842,884,240,465,255,360,493,794,958,421,25,458,741,910,7,566,415],[982,783,794,457,230,440,247,260,489,487,145,234,452,291,369,669,498,614,955,952,153,993,852,535,701,90,193],[308,956,531,647,690,126,969,61,159,352,38,343,891,637,825,165,785,922,480,400,695,193,422,509,197,172,401],[49,806,971,822,791,985,348,909,779,699,850,534,193,742,336,188,532,946,556,730,872,609,597,445,156,649,706],[633,506,921,680,585,952,219,613,452,34,249,500,927,619,864,326,570,749,202,1,45,64,138,249,454,896,691],[625,230,677,701,112,883,989,776,529,436,947,662,650,294,907,700,347,506,702,197,168,382,571,864,366,735,449],[401,450,680,326,867,480,69,151,226,773,117,770,160,977,959,404,974,476,725,554,216,914,377,722,48,22,416],[213,90,875,423,600,584,895,810,422,554,216,649,5,984,685,140,544,659,929,502,317,390,557,551,68,81,620],[994,749,505,771,16,209,430,632,776,369,320,86,763,24,786,828,245,629,992,887,29,603,885,982,525,377,158],[477,265,113,608,458,286,900,859,225,392,394,764,519,950,348,234,844,605,271,959,92,46,159,324,642,599,578],[497,65,979,540,491,446,328,395,747,894,25,120,445,622,681,959,986,137,780,146,907,32,122,723,441,254,33],[645,279,271,394,119,353,299,383,631,823,653,195,763,845,555,555,62,347,528,566,15,166,930,508,840,23,653],[884,265,340,141,353,102,629,575,428,979,810,777,70,258,585,107,534,77,882,601,132,497,36,533,861,801,229]]
// Output: 503
//

LEETCODE_SOLUTION_UNITTEST_WITH_TIMED_OUT(2614, PrimeInDiagonal,
                                          extra_testcase_3, 4006) {
  auto                solution = MakeSolution();
  vector<vector<int>> nums     = {
      {740,  493,  326, 111,   693,  464,  378,  599,  714, 260,   683,  499,  832,  795,
       235,  945,  163,   576,  565, 848,  917,    80, 800,  877,  521,   943,  908 },
      {173,   27, 848, 659,   870,  171,  900,  530,  419, 623,   677,  214,  449,  726,
       701,  415,  271,    22, 602, 138,  942,   398,  176,  907,  452,   579,   55 },
      {939,  385,  952, 822,    89, 660,  603,  415,  343, 239,   519,  895,  467,   41,
       492,  635,  105,   276,  854, 520,  503,   565,  661,  404,  485,   272,  186},
      {236,  554,  374, 164,   310,  873,  624,  852,  939, 148,   468,   71, 986,   71,
       490,  403,  580,   976,  420, 570,   95,  272,  494,  236,  835,   114,  304 },
      {145,  369,  832,  97,  142,  675,  885,   59, 843, 682,   141,  601,  573,  204,
       8, 34, 883,   415,  572, 717,  774,   617,  503,  732,  707,   110,  954     },
      {485,  573,  356, 896,   799,  352,  894,  100,  703,   6, 248,  233,  510,  859,
       319,  282,  231,    10, 508, 364,  970,   978,  522,  949,  350,    94,  80  },
      {313,  588,  433, 232,   757,  377,  987,  391,  882, 777,   149,  238,  295,  959,
       205,  761,  795,   493,  676, 902,  801,   368,  290,  394,  628,   133,  852},
      {798,  123,  411, 364,   513,  890,  483,  235,  672, 727,   383,  648,  938,  368,
       443,  285,  368,   997,  411, 786,  785,   732,  290,  888,  108,   492,  926},
      {299,  124,  457, 158,   353,  956,  250,  762,  192, 952,   979,  347,  512,  235,
       113,  698,  394,   999,  399, 476,  526,   473,  959,  580,  849,   633,  226},
      {692,  409,  515, 319,   499,  239,  323,  531,  701,   2,   95, 484,  325,  404,
       913,  973,  233,   841,  991, 442,   50,  590,  790,   42,  417,    96, 270  },
      {206,  743,  335, 183,   116,  186,  817,  716,  373,  29,  240,  976,   45,    9,
       392,  548,    5, 133,  120, 842,  620,   621,  958,  935,  205,    84, 759   },
      {478,  203,  869,   2, 533,  919,  637,  867,  426,  69,  550, 182,  949,  240,
       233,  951,  426,   392,  487, 827,    1, 447,  216,  391, 1000,   784,   43  },
      {631,  978,  276,  30,  597,  356,  721,  377,  847, 346,   694,  465,  657,  138,
       611,  530,   95,  258,  968, 106,  732,   106,  280,   25, 709,   146,  636  },
      {791,  675,  140, 389,   213,  587, 1000,  676,  328, 207,   432,  521,  513,  124,
       574,  109,  710,   933,  487, 128,  522,  915,  459,  482,  183,   466,  561 },
      {348,  132,  427, 261,   387,   81, 579,  518,  344, 840,   842,  884,  240,  465,
       255,  360,  493,   794,  958, 421,   25,  458,  741,  910,    7, 566,  415   },
      {982,  783,  794, 457,   230,  440,  247,  260,  489, 487,   145,  234,  452,  291,
       369,  669,  498,   614,  955, 952,  153,   993,  852,  535,  701,    90, 193 },
      {308,  956,  531, 647,   690,  126,  969,   61, 159, 352,    38, 343,  891,  637,
       825,  165,  785,   922,  480, 400,  695,   193,  422,  509,  197,   172,  401},
      { 49, 806,  971, 822,   791,  985,  348,  909,  779, 699,   850,  534,  193,  742,
       336,  188,  532,   946,  556, 730,  872,   609,  597,  445,  156,   649,  706},
      {633,  506,  921, 680,   585,  952,  219,  613,  452,  34,  249,  500,  927,  619,
       864,  326,  570,   749,  202,   1, 45,   64, 138,  249,  454,   896,  691    },
      {625,  230,  677, 701,   112,  883,  989,  776,  529, 436,   947,  662,  650,  294,
       907,  700,  347,   506,  702, 197,  168,   382,  571,  864,  366,   735,  449},
      {401,  450,  680, 326,   867,  480,   69, 151,  226, 773,   117,  770,  160,  977,
       959,  404,  974,   476,  725, 554,  216,   914,  377,  722,   48,   22, 416  },
      {213,   90, 875, 423,   600,  584,  895,  810,  422, 554,   216,  649,    5, 984,
       685,  140,  544,   659,  929, 502,  317,   390,  557,  551,   68,   81, 620  },
      {994,  749,  505, 771,    16, 209,  430,  632,  776, 369,   320,   86, 763,   24,
       786,  828,  245,   629,  992, 887,   29,  603,  885,  982,  525,   377,  158 },
      {477,  265,  113, 608,   458,  286,  900,  859,  225, 392,   394,  764,  519,  950,
       348,  234,  844,   605,  271, 959,   92,   46, 159,  324,  642,   599,  578  },
      {497,   65, 979, 540,   491,  446,  328,  395,  747, 894,    25, 120,  445,  622,
       681,  959,  986,   137,  780, 146,  907,    32, 122,  723,  441,   254,   33 },
      {645,  279,  271, 394,   119,  353,  299,  383,  631, 823,   653,  195,  763,  845,
       555,  555,   62,  347,  528, 566,   15,  166,  930,  508,  840,    23, 653   },
      {884,  265,  340, 141,   353,  102,  629,  575,  428, 979,   810,  777,   70,  258,
       585,  107,  534,    77, 882, 601,  132,   497,   36, 533,  861,   801,  229  }
  };
  int expect = 503;
  int actual = solution->diagonalPrime(nums);
  LCD_EXPECT_EQ(expect, actual);
}
